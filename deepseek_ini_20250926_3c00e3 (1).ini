[PARSER]
    Name        github_worker
    Format      regex
    Regex       ^\[(?<time>\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2})z (?<level>\w+)(?<source>[^\]]*)\](?<message>.*)
    Time_Key    time
    Time_Format %Y-%m-%d %H:%M:%S
    Time_Keep   On

[MULTILINE_PARSER]
    name          github_worker_multiline
    type          regex
    flush_timeout 1000
    # Rule for start_state: matches lines beginning with [YYYY-MM-DD HH:MM:SSz LEVEL]
    rule          "start_state"   "^\[[0-9]{4}-[0-9]{2}-[0-9]{2} [0-9]{2}:[0-9]{2}:[0-9]{2}z [A-Z]+\]"  "cont"
    # Rule for continuation: continue until we see another timestamp pattern
    rule          "cont"          "^(?!\[[0-9]{4}-[0-9]{2}-[0-9]{2} [0-9]{2}:[0-9]{2}:[0-9]{2}z [A-Z]+\])"  "cont"

[MULTILINE_PARSER]
    name          github_worker_multiline
    type          regex
    flush_timeout 1000
    rule          "start_state"  "^\[\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}z \w+[^\]]*\]"  "cont"
    rule          "cont"         "^(?!\[\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}z \w+[^\]]*\])"  "cont"
